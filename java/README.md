
Code migrated from c++ using deepseek.